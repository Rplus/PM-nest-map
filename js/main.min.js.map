{"version":3,"file":"main.min.js","sources":["u/get-position.js","u/urls.js","u/u.js","create-mark-content.js","set-mark.js","post-data.js","dialog.js","get-data.js","map-layers.js","map.js","btn-locate-me.js","btn-re-fetch.js","aside.js","add-report.js","btn-add-report.js","filters.js","ctrls.js","center-mark.js","main.src.js"],"sourcesContent":["export default function getPosition() {\n  const urlParams = new URLSearchParams(location.search);\n\n  const lat = urlParams.get('lat') || localStorage.getItem('lat') || 25.052920;\n  const lng = urlParams.get('lng') || localStorage.getItem('lng') || 121.556237;\n  const zoom = urlParams.get('zoom') || localStorage.getItem('zoom') || 15;\n\n  return {\n    latLng: [+lat, +lng],\n    zoom: +zoom,\n  };\n};","export let urls = {\n  GAS: 'https://script.google.com/macros/s/AKfycbwv0HHiEgWwxtdasGMxrBRf5zD3CP8Yip-2PPegoVhmdRMAu-9_/dev?id=1N9aa3LZMaFwNbjUSGVD9NloBNE7sM0DY318-DtZHzVo',\n}\n","export function toJSON(d) {\n  return d.json();\n};\n\n\nexport function fetchJSON(url) {\n  return fetch(url).then(toJSON);\n};\n\n\nexport function isNumeric(n) {\n  return !isNaN(parseFloat(n)) && isFinite(n);\n};\n\n\nexport function UID() {\n  let uid = localStorage.getItem('uid');\n  if (!uid || (uid.indexOf('-') === -1)) {\n    uid = (\n      navigator.userAgent\n        .replace(/\\D/g, '')\n        .match(/(\\d{6,11})/g)\n        .map(d => (+d).toString(36)).join('-') +\n        Math.random().toString(36)\n    );\n    localStorage.setItem('uid', uid);\n  }\n  return uid;\n}\n\n\nexport function getPlanText(str) {\n  var text = document.createTextNode(str);\n  var p = document.createElement('p');\n  p.appendChild(text);\n  return p.innerHTML;\n}\n\n// export function myFetch(url, type = 'json') {\n//   return fetch(url).then(res => {\n//     switch (type) {\n//       case 'text':\n//         return res.text();\n//       case 'json':\n//       default:\n//         return res.json();\n//     }\n//   })\n// }\n\n\nexport function navigation(targetLngLat, nowLngLat) {\n  if (navigator.userAgent.match(/android/i)) {\n    return `google.navigation:q=${targetLngLat}&mode=w`;\n  } else if (nowLngLat == 'undefined,undefined') {\n    return `http://maps.google.com?q=${targetLngLat}`;\n  } else {\n    if (navigator.userAgent.match(/(iphone|ipod|ipad);?/i)) {\n      return `comgooglemaps://?saddr=&daddr=${targetLngLat}&directionsmode=Driving&zoom=15`;\n    } else {\n      return `https://www.google.com.tw/maps/dir/${targetLngLat}/${nowLngLat}/@24,120.5,10z/data=!3m1!4b1!4m2!4m1!3e0`;\n    }\n  };\n  return '';\n}\n","import { navigation, getPlanText } from './u/u.js';\n\nexport default function createMarkerContent(report) {\n  let googleNavigation = navigation(\n    `${report.lat},${report.lng}`,\n    `${window.info.nowlatlng.lat},${window.info.nowlatlng.lng}`\n  );\n\n  let updateDate = (report.timestamp || '').split('T')[0];\n\n  return `\n    <div class=\"popup-content\">\n      #${report.dex} ${report.name}: ${report.scale}+/hr\n      <div class=\"note\">\n        ${getPlanText(report.note || '')}\n        <time class=\"updatetime\" datetime=\"${report.timestamp}\">${updateDate}</time>\n      </div>\n      <hr>\n      <div class=\"popup-content--footer\">\n        <a class=\"fix-reoprt\" href=\"###\"\n          data-lat=\"${report.lat}\"\n          data-lng=\"${report.lng}\"\n          data-scale=\"${report.scale}\"\n          data-name=\"${report.name}\"\n          data-note=\"${report.note || ''}\"\n          data-dex=\"${report.dex}\"\n        >\n          ‰øÆÊ≠£Êã≥üëä\n        </a>\n        <a href=\"${googleNavigation}\" target=\"_blank\">Go‚ÜóÔ∏è</a>\n      </div>\n    </div>\n  `;\n};\n","import createMarkerContent from './create-mark-content.js';\nimport map from './map.js';\n\nconst microseconds_for_week = 60 * 60 * 24 * 7 * 1000;\n\nexport function setMark(report) {\n  let iconSize = map.getZoom() < 14 ? 32 : 48;\n  let isOld = (new Date() - new Date(report.timestamp)) / microseconds_for_week > 2;\n\n  let marker = Leaflet.marker(\n    [report.lat, report.lng],\n    {\n      icon: L.divIcon({\n        className: `poke-icon poke-icon-${report.dex} ${isOld ? 'is-old' : 'is-new'}`,\n        html: `\n          <img\n            class=\"pm-img\"\n            src=\"./img/z/${report.dex}.png\"\n            title=\"#${report.dex} ${report.name}, ${report.scale}+/hr\"\n          >`,\n        iconSize: [iconSize, iconSize],\n        iconAnchor: [iconSize / 2, iconSize / 2],\n        popupAnchor: [0, -iconSize / 3]\n      }),\n      title: `${report.scale}`,\n      report: report,\n    }\n  )\n  .bindPopup(createMarkerContent(report), {\n    autoPan: false,\n  });\n\n  window.markers.set(`${report.lat},${report.lng}`, marker);\n}\n","import * as u from './u/u.js';\n\nexport function postData(_dialog) {\n\n  if (!u.isNumeric(_dialog.elm.dex.value)) {\n    return Promise.reject(new Error('fail'));\n  }\n\n  let data = new URLSearchParams({\n    'dex': _dialog.elm.dex.value,\n    'lat': _dialog.elm.lat.value,\n    'lng': _dialog.elm.lng.value,\n    'scale': _dialog.elm.scale.value,\n    'note': _dialog.elm.note.value,\n    'type': _dialog.elm.type.value,\n    'uid': window.info.uid,\n    'timestamp': +new Date(),\n    'id': window.info.SpreadsheetId,\n  });\n\n  return new Promise((resolve, reject) => {\n    let xhr = new XMLHttpRequest();\n    xhr.open(\"POST\", _dialog.elm.form.action, true);\n    xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');\n    xhr.addEventListener('loadstart', () => {\n      if (_dialog.postTimer) {\n        window.clearTimeout(_dialog.postTimer);\n        _dialog.postTimer = null;\n      }\n      _dialog.postTimer = setTimeout(() => {\n        if (xhr.status === 200) { return; }\n\n        xhr.abort();\n        _dialog.postTimer = null;\n        reject();\n      }, 1000);\n    });\n    xhr.addEventListener('load', resolve);\n    xhr.addEventListener('error', reject);\n    xhr.addEventListener('abort', reject);\n    xhr.send(data.toString());\n  });\n}\n","import { postData } from './post-data.js';\nimport { getData } from './get-data.js';\nimport { urls } from './u/urls.js';\nimport * as u from './u/u.js';\n\nlet _dialog = document.createElement('div');\n_dialog.id = 'dialog';\n_dialog.hidden = true;\n_dialog.className = 'dialog';\nwindow._dialog = _dialog;\n\n_dialog.innerHTML = `\n  <form id=\"report-form\" class=\"report-form dialog-content\" action=\"${urls.GAS}\">\n    <dl class=\"report-content\">\n      <dt>ÂØ∂ÂèØÂ§¢Á∑®ËôüÔºö</dt>\n      <dd id=\"rp-data--dex-box\">\n        <input required id=\"rp-data--dex\" type=\"text\" list=\"rp-data--pm-list\" pattern=\"[0-9.]+\">\n        <datalist id=\"rp-data--pm-list\"></datalist>\n      </dd>\n\n      <dt>Â∑¢Á©¥Ë¶èÊ®°(ÊØèÂ∞èÊôÇÊï∏Èáè)Ôºö</dt>\n      <dd id=\"rp-data--scale-box\">\n        <select required id=\"rp-data--scale\">\n          <option value=\"1\" label=\"1~5\"></option>\n          <option value=\"5\" label=\"5+\"></option>\n          <option value=\"15\" label=\"15+\"></option>\n        </select>\n      </dd>\n\n      <dt>Â∑¢Á©¥/ÈáçÁîüÈªûË®ªËß£Ôºö</dt>\n      <dd id=\"rp-data--note-box\">\n        <input id=\"rp-data--note\" type=\"text\">\n      </dd>\n\n      <dd>\n        <input required type=\"hidden\" readonly id=\"rp-data--type\" value=\"\">\n        <input required type=\"hidden\" id=\"rp-data--lat\" value=\"\">\n        <input required type=\"hidden\" id=\"rp-data--lng\" value=\"\">\n      </dd>\n    </dl>\n    <div class=\"submit-box\">\n      <input id=\"submit\" disabled type=\"submit\" />\n    </div>\n    <div class=\"close-dialog\">‚ùå</div>\n  </form>\n  `;\n\n\n_dialog.elm = {\n  lat: _dialog.querySelector('#rp-data--lat'),\n  lng: _dialog.querySelector('#rp-data--lng'),\n  dex: _dialog.querySelector('#rp-data--dex'),\n  pmList: _dialog.querySelector('#rp-data--pm-list'),\n  scale: _dialog.querySelector('#rp-data--scale'),\n  type: _dialog.querySelector('#rp-data--type'),\n  note: _dialog.querySelector('#rp-data--note'),\n  submit: _dialog.querySelector('#submit'),\n  closeBtn: _dialog.querySelector('.close-dialog'),\n  form: _dialog.querySelector('form'),\n};\n\n_dialog.close = () => {\n  _dialog.hidden = true;\n};\n_dialog.show = () => {\n  _dialog.hidden = false;\n};\n\n_dialog.elm.closeBtn.addEventListener('click', _dialog.close.bind(_dialog))\n\n_dialog.postCB = () => {\n  _dialog.close();\n  _dialog.elm.submit.disabled = false;\n  getData();\n};\n\n\nfunction validateForm(arg = {}) {\n  if (!_dialog.elm.form.checkValidity()) {\n    alert('Ë´ãÁ¢∫Ë™çË°®ÂñÆÊ†ºÂºè:\\n* Á∑®Ëôü: Êï∏Â≠óÊ†ºÂºè\\n\\nÁõÆÂâçÂ∑≤Ëº∏ÂÖ•ÁöÑÂØ∂ÂèØÂ§¢Á∑®Ëôü:\\n' + _dialog.elm.dex.value);\n  }\n  _dialog.elm.submit.disabled = arg.forceDisabled || !_dialog.elm.form.checkValidity();\n};\n\nfunction submitFn(e) {\n  e.preventDefault();\n  validateForm({ forceDisabled: true });\n\n  postData(_dialog)\n  .then(d => {\n    _dialog.postCB();\n  })\n  .catch(err => {\n    _dialog.postCB();\n    // alert('Ë´ãÁ¢∫Ë™ç„ÄåÂØ∂ÂèØÂ§¢Á∑®Ëôü„ÄçÁÇ∫Êï∏Â≠óÔºÅ');\n    console.log('catch', err);\n  });\n};\n\n_dialog.elm.form.addEventListener('submit', submitFn);\n_dialog.elm.form.addEventListener('change', validateForm);\n\n_dialog.initReport = (param) => {\n  if (_dialog.open) {\n    return;\n  }\n  console.log(param);\n  _dialog.elm.lat.value = param.lat;\n  _dialog.elm.lng.value = param.lng;\n  _dialog.elm.dex.value = param.dex || '';\n  _dialog.elm.scale.value = param.scale || '';\n  _dialog.elm.note.value = param.note || '';\n  _dialog.elm.type.value = (param.new ? 'new' : 'update');\n  _dialog.elm.form.dataset.type = (param.new ? 'new' : 'update');\n\n  validateForm();\n\n  _dialog.show();\n  _dialog.elm.dex.select();\n};\n\n\nexport default _dialog;\n\nlet returnOption = (value, label) => `<option value=\"${value}\" label=\"${label}\"></option>`;\n\nexport function createNamesOption(names) {\n  _dialog.elm.pmList.innerHTML = names.map(\n    (name, idx) => name[1] ? returnOption(idx + 1, name[0]) : null\n  ).join('') + returnOption(0.5, 'Ôºü', 1);\n};\n","import { urls } from './u/urls.js';\nimport * as u from './u/u.js';\nimport { setMark } from './set-mark.js';\nimport { earseMarkers } from './map.js';\nimport { renderMarkersInView } from './map.js';\nimport { createNamesOption } from './dialog.js';\n\nexport function getData() {\n  console.log('re-fetching~~~');\n\n  let checkLatLng = (data) => !(isNaN(data.lat) && isNaN(data.lng));\n\n  Promise.all([\n    u.fetchJSON(urls.GAS),\n    u.fetchJSON(`${urls.GAS}&method=get_pm_name`),\n  ])\n  .then(d => {\n    let data = d[0].data.filter(checkLatLng);\n    let pmNames = d[1];\n\n    createNamesOption(pmNames);\n    window.info.pmNames = pmNames;\n\n    data.forEach(d => {\n      d.name = pmNames.map(n => n[0])[d.dex - 1] || '?';\n    });\n\n    if (window.markers) {\n      earseMarkers(window.markers);\n    }\n\n    window.markers = new Map();\n    data.forEach(setMark);\n    renderMarkersInView();\n  });\n}\n","window.Leaflet = window.L;\nvar twBounds = L.latLngBounds(\n  L.latLng(21.92,118),\n  L.latLng(26,122.5)\n);\n\n// layers source: https://leaflet-extras.github.io/leaflet-providers/preview/\n\nexport let layers = {\n  'Google': Leaflet.tileLayer(\n    'https://{s}.google.com/vt/lyrs=m&x={x}&y={y}&z={z}', {\n      bounds: twBounds,\n      maxZoom: 20,\n      subdomains: ['mt0', 'mt1', 'mt2', 'mt3'],\n      attribution: '&copy; Google Map',\n    }),\n\n  'Wikimedia': Leaflet.tileLayer(\n    'https://maps.wikimedia.org/osm-intl/{z}/{x}/{y}{r}.png', {\n      minZoom: 1,\n      maxZoom: 19,\n      attribution: '<a href=\"https://wikimediafoundation.org/wiki/Maps_Terms_of_Use\">Wikimedia</a>',\n    }),\n\n  'Esri.WorldStreetMap': Leaflet.tileLayer(\n    'https://server.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer/tile/{z}/{y}/{x}', {\n      attribution: 'Tiles &copy; Esri &mdash; Source: Esri, DeLorme, NAVTEQ, USGS, Intermap, iPC, NRCAN, Esri Japan, METI, Esri China (Hong Kong), Esri (Thailand), TomTom, 2012'\n    }),\n  // 'Stamen.Toner': Leaflet.tileLayer(\n  //   'https://stamen-tiles-{s}.a.ssl.fastly.net/toner/{z}/{x}/{y}{r}.{ext}', {\n  //     attribution: 'Map tiles by <a href=\"http://stamen.com\">Stamen Design</a>, <a href=\"http://creativecommons.org/licenses/by/3.0\">CC BY 3.0</a> &mdash; Map data &copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',\n  //     subdomains: 'abcd',\n  //     minZoom: 0,\n  //     maxZoom: 20,\n  //     ext: 'png'\n  //   }),\n  'Stamen.TonerLite': Leaflet.tileLayer(\n    'https://stamen-tiles-{s}.a.ssl.fastly.net/toner-lite/{z}/{x}/{y}{r}.{ext}', {\n      attribution: 'Map tiles by <a href=\"http://stamen.com\">Stamen Design</a>, <a href=\"http://creativecommons.org/licenses/by/3.0\">CC BY 3.0</a> &mdash; Map data &copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',\n      subdomains: 'abcd',\n      minZoom: 0,\n      maxZoom: 20,\n      ext: 'png'\n    }),\n\n  'Hydda.Full': Leaflet.tileLayer(\n    'https://{s}.tile.openstreetmap.se/hydda/full/{z}/{x}/{y}.png', {\n      maxZoom: 18,\n      attribution: 'Tiles courtesy of <a href=\"http://openstreetmap.se/\" target=\"_blank\">OpenStreetMap Sweden</a> &mdash; Map data &copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\n    }),\n\n  'Hydda.Base': Leaflet.tileLayer(\n    'https://{s}.tile.openstreetmap.se/hydda/base/{z}/{x}/{y}.png', {\n      maxZoom: 18,\n      attribution: 'Tiles courtesy of <a href=\"http://openstreetmap.se/\" target=\"_blank\">OpenStreetMap Sweden</a> &mdash; Map data &copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\n    }),\n\n  'CartoDB.Positron': Leaflet.tileLayer(\n    'https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {\n      attribution: '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors &copy; <a href=\"https://carto.com/attributions\">CARTO</a>',\n      subdomains: 'abcd',\n      maxZoom: 19\n    }),\n\n  'CartoDB.PositronNoLabels': Leaflet.tileLayer(\n    'https://{s}.basemaps.cartocdn.com/light_nolabels/{z}/{x}/{y}{r}.png', {\n      attribution: '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors &copy; <a href=\"https://carto.com/attributions\">CARTO</a>',\n      subdomains: 'abcd',\n      maxZoom: 19\n    }),\n\n  'CartoDB.Voyager': Leaflet.tileLayer(\n    'https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png', {\n      attribution: '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors &copy; <a href=\"https://carto.com/attributions\">CARTO</a>',\n      subdomains: 'abcd',\n      maxZoom: 19\n    }),\n\n  'CartoDB.VoyagerNoLabels': Leaflet.tileLayer(\n    'https://{s}.basemaps.cartocdn.com/rastertiles/voyager_nolabels/{z}/{x}/{y}{r}.png', {\n      attribution: '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors &copy; <a href=\"https://carto.com/attributions\">CARTO</a>',\n      subdomains: 'abcd',\n      maxZoom: 19\n    }),\n\n  'Stamen.Watercolor': Leaflet.tileLayer(\n    'https://stamen-tiles-{s}.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.{ext}', {\n      attribution: 'Map tiles by <a href=\"http://stamen.com\">Stamen Design</a>, <a href=\"http://creativecommons.org/licenses/by/3.0\">CC BY 3.0</a> &mdash; Map data &copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',\n      subdomains: 'abcd',\n      minZoom: 1,\n      maxZoom: 16,\n      ext: 'jpg'\n    }),\n\n  'Stamen.Terrain': Leaflet.tileLayer(\n    'https://stamen-tiles-{s}.a.ssl.fastly.net/terrain/{z}/{x}/{y}{r}.{ext}', {\n      attribution: 'Map tiles by <a href=\"http://stamen.com\">Stamen Design</a>, <a href=\"http://creativecommons.org/licenses/by/3.0\">CC BY 3.0</a> &mdash; Map data &copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',\n      subdomains: 'abcd',\n      minZoom: 0,\n      maxZoom: 18,\n      ext: 'png'\n    }),\n}\n\nexport let labels = {\n  'Stamen.TonerLabels': Leaflet.tileLayer(\n    'https://stamen-tiles-{s}.a.ssl.fastly.net/toner-labels/{z}/{x}/{y}{r}.{ext}', {\n      attribution: 'Map tiles by <a href=\"http://stamen.com\">Stamen Design</a>, <a href=\"http://creativecommons.org/licenses/by/3.0\">CC BY 3.0</a> &mdash; Map data &copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',\n      subdomains: 'abcd',\n      ext: 'png'\n    }),\n};\n","/* global L */\n\nimport getPosition from './u/get-position.js';\nimport { getData } from './get-data.js';\nimport { layers, labels } from './map-layers.js';\n\nwindow.Leaflet = window.L;\n\nlet layerName = localStorage.getItem('custom-layer');\n\nconst map = Leaflet.map('map', {\n  layers: [ layers[layerName] || layers.Google]\n});\n\nwindow._map = map;\n\nlet position = getPosition();\nLeaflet.control.layers(layers, labels).addTo(map);\n\nmap\n  .on('moveend', setPosition)\n  .on('moveend', renderMarkersInView)\n  .on('load', onLoad)\n  .on('locationfound', onLocationFound)\n  .on('locationerror', onLocationError)\n  .on('baselayerchange', saveLayerName)\n  .setView(position.latLng, position.zoom)\n\n\nfunction setPosition() {\n  if (!map) { return; }\n\n  let geo = map.getCenter();\n  let [lat, lng] = [geo.lat, geo.lng];\n\n  localStorage.setItem('lat', lat);\n  localStorage.setItem('lng', lng);\n  localStorage.setItem('zoom', map.getZoom());\n};\n\n\nlet markersInView = [];\nexport function renderMarkersInView() {\n  let bounds = map.getBounds();\n\n  let checkInView = (_marker, _latLng) => {\n    let inView = bounds.contains(L.latLng.apply(null, _latLng.split(',')));\n\n    if (inView) {\n      markersInView.push(_marker);\n      _marker.addTo(map);\n      if (_marker.isDoubtful) {\n        _marker._icon && _marker._icon.classList.add('is-doubtful');\n      }\n    }\n    return inView;\n  };\n\n  if (window.markers) {\n    earseMarkers(markersInView); // clear markers in view at first\n    markersInView = [];\n    window.markers.forEach(checkInView);\n  }\n}\n\n\nfunction onLoad() {\n  getData();\n  setPosition();\n};\n\n\nfunction onLocationFound(e) {\n  window.info.nowlatlng = e.latlng;\n  const radius = e.accuracy / 2;\n  if (map.circle) {\n    map.removeLayer(map.circle);\n  }\n  map.circle = Leaflet.circle(e.latlng, radius).addTo(map);\n};\n\n\nfunction onLocationError(e) {\n  console.warn(e.message);\n  document.title = `[GG] - ${document.title}`;\n};\n\nfunction saveLayerName(e) {\n  localStorage.setItem('custom-layer', e.name);\n};\n\n\n\nexport default map;\n\n\nexport function earseMarkers(markers) {\n  markers.forEach(m => map.removeLayer(m));\n}\n","import map from './map.js';\n\nfunction createLocateBtn() {\n  let dom = document.createElement('button');\n  dom.id = 'locate-me';\n  dom.innerText = '‚¶ø';\n  dom.addEventListener('click', locateMe);\n  return dom;\n}\n\nfunction locateMe() {\n  map.locate({\n    setView: true,\n    maxZoom: Math.max(map.getZoom(), 16)\n  });\n}\n\nlet locateMeBtn = createLocateBtn();\n\nexport default locateMeBtn;\n","import { getData } from './get-data.js';\n\nfunction createReFetchBtn() {\n  let dom = document.createElement('button');\n  dom.id = 're-fetch';\n  dom.innerText = '‚Üª';\n  dom.addEventListener('click', getData);\n  return dom;\n}\n\nlet reFetchBtn = createReFetchBtn();\n\nexport default reFetchBtn;\n","let aside = document.createElement('aside');\n\naside.id = 'info';\naside.className = 'info dialog';\n\naside.innerHTML = `\n  <a class=\"reset-info\" href=\"#\"></a>\n  <article class=\"info-article dialog-content\">\n    <a href=\"#\" class=\"close-dialog close-info\">‚ùå</a>\n    <h1>„Äê ÂØ∂ÂèØÂ§¢Â∑¢Á©¥Âú∞Âúñ „Äë</h1>\n    <ul>\n      <li>\n        Êìç‰Ωú‰ªãÁ¥πËàáÊïôÂ≠∏Ôºö\n        <br>\n        <a href=\"https://github.com/Rplus/PM-nest-map/blob/master/USAGE.md\">\n          https://github.com/Rplus/PM-nest-map/blob/master/USAGE.md\n        </a>\n      </li>\n\n      <li>\n        Â∞àÊ°àÂéüÂßãÁ¢ºÔºö\n        <br>\n        <a href=\"https://github.com/Rplus/PM-nest-map\">\n          https://github.com/Rplus/PM-nest-map\n        </a>\n      </li>\n\n      <li>\n        ÂïèÈ°åÂõûÂ†±Ôºö\n        <br>\n        <a href=\"https://github.com/Rplus/PM-nest-map/issues\">\n          https://github.com/Rplus/PM-nest-map/issues\n        </a>\n      </li>\n\n      <li>\n        ÂØ∂ÂèØÂ§¢ÂúñÁ§∫‰æÜÊ∫êÔºö\n        <br>\n        <a href=\"https://archives.bulbagarden.net/w/index.php?title=Category:Shuffle_icons&fileuntil=115%0AShuffle115M.png#mw-category-media\">\n          Category:Shuffle icons - Bulbagarden Archives\n        </a>\n      </li>\n\n      <li>\n        Âú∞ÂúñÂúñË≥áÔºö\n        <br>\n        ¬© OpenStreetMap & Google map\n      </li>\n\n      <li>\n        <input id=\"lighten-map\" type=\"checkbox\" />\n        <label for=\"lighten-map\">\n          Ê∑°ÂåñÂú∞ÂúñÔºü\n        </label>\n      </li>\n    </ul>\n  </article>\n`;\n\nexport default aside;\n\nlet infoBtn = document.createElement('div');\ninfoBtn.className = 'info-btn button';\n\ninfoBtn.innerHTML = `\n  <button>Ë®ª</button>\n  <a href=\"#info\" title=\"Ë™™Êòé\"></a>\n`;\n\nlet lightenMap = aside.querySelector('#lighten-map');\nlightenMap.checked = (localStorage.getItem('lighten-map') === 'true'); // init\n\nlet checkToLightenMap = () => {\n  document.body.classList.toggle('lighten-map', lightenMap.checked);\n};\n\nlightenMap.addEventListener('change', () => {\n  localStorage.setItem('lighten-map', lightenMap.checked);\n  checkToLightenMap();\n});\n\ncheckToLightenMap();\n\nexport { infoBtn }\n","/* global _map */\n\nimport dialog from './dialog.js';\n\nexport function addReport(params) {\n  let { lat, lng } = _map.getCenter();\n\n  let defaultParams = {\n    dex: 0.5,\n    lat,\n    lng,\n    scale: 1,\n    new: true,\n    note: '',\n  };\n\n  dialog.initReport({\n    ...defaultParams,\n    ...params,\n  });\n};\n\ndocument.body.addEventListener('click', (e) => {\n  if (e.target.className === 'fix-reoprt') {\n    e.preventDefault();\n    let data = e.target.dataset;\n    console.log(data);\n\n    addReport({\n      lat: +data.lat,\n      lng: +data.lng,\n      scale: +data.scale,\n      dex: +data.dex,\n      new: !!data.new,\n      note: data.note,\n    });\n  }\n})\n","import { addReport } from './add-report.js';\n\nfunction createAddReportBtn() {\n  let dom = document.createElement('button');\n  dom.id = 'add-report';\n  dom.innerText = '+';\n  dom.addEventListener('click', addReport);\n  return dom;\n}\n\nlet addReportBtn = createAddReportBtn();\n\nexport default addReportBtn;\n","let filterBoxClass = 'filters';\n\nfunction createIndicator(dom) {\n  return (`\n    <input type=\"checkbox\" name=\"Filter\" id=\"Filter\">\n    <label for=\"Filter\">Filter</label>\n    <div class=\"${filterBoxClass}\">\n      <style>${dom.style}</style>\n      ${dom.filter}\n    </div>\n  `);\n}\n\nvar scales = [1, 5, 15];\nlet dom = scales.reduce((all, scale) => {\n  all.input.push(`\n    <input\n      type=\"checkbox\"\n      class=\"ckbox-filter\"\n      id=\"ckbox_${scale}\" checked />`);\n  all.label.push(`<label class=\"filter-label\" for=\"ckbox_${scale}\" data-scale=\"${scale}\"></label>`);\n  all.style.push(`\n    #ckbox_${scale}:not(:checked) ~ #map .poke-icon[title=\"${scale}\"] { display: none; }\n    #ckbox_${scale}:not(:checked) ~ .ctrls label[data-scale=\"${scale}\"] { filter: contrast(0%); }\n  `);\n  return all;\n}, { input: [], label: [], style: [] });\n\ndocument.querySelector('#map').insertAdjacentHTML('beforebegin', dom.input.join(''));\n\nlet filterIndicator = createIndicator({\n  style: dom.style.join(''),\n  filter: dom.label.join(''),\n});\n\nexport default filterIndicator;\n","import locateMeBtn from './btn-locate-me.js';\nimport reFetchBtn from './btn-re-fetch.js';\nimport { infoBtn } from './aside.js';\nimport addReportBtn from './btn-add-report.js';\nimport filterIndicator from './filters.js';\n\nlet ctrls = document.createElement('div');\nctrls.className = 'ctrls';\n\nctrls.appendChild(addReportBtn);\nctrls.appendChild(locateMeBtn);\nctrls.appendChild(reFetchBtn);\nctrls.appendChild(infoBtn);\nctrls.insertAdjacentHTML('beforeend', filterIndicator);\n\nexport default ctrls;\n","let centerMark = document.createElement('span');\ncenterMark.id = 'center-mark';\n\nexport default centerMark;\n","import map from './map.js';\nimport ctrls from './ctrls.js';\nimport dialog from './dialog.js';\nimport aside from './aside.js';\nimport centerMark from './center-mark.js';\nimport { urls } from './u/urls.js';\nimport * as u from './u/u.js';\n\nwindow.info = {\n  nowlatlng: {},\n  SpreadsheetId: '1N9aa3LZMaFwNbjUSGVD9NloBNE7sM0DY318-DtZHzVo',\n  uid: u.UID(),\n};\n\ndocument.body.appendChild(ctrls);\ndocument.body.appendChild(dialog);\ndocument.body.appendChild(aside);\ndocument.body.appendChild(centerMark);\n"],"names":["getPosition","urlParams","URLSearchParams","location","search","lat","get","localStorage","getItem","lng","zoom","latLng","urls","GAS","toJSON","d","json","fetchJSON","url","fetch","then","isNumeric","n","isNaN","parseFloat","isFinite","UID","uid","indexOf","navigator","userAgent","replace","match","map","toString","join","Math","random","setItem","getPlanText","str","text","document","createTextNode","p","createElement","appendChild","innerHTML","navigation","targetLngLat","nowLngLat","createMarkerContent","report","googleNavigation","window","info","nowlatlng","updateDate","timestamp","split","dex","name","scale","note","microseconds_for_week","setMark","iconSize","getZoom","isOld","Date","marker","Leaflet","icon","L","divIcon","className","html","iconAnchor","popupAnchor","title","bindPopup","autoPan","markers","set","postData","_dialog","u","elm","value","Promise","reject","Error","data","type","SpreadsheetId","resolve","xhr","XMLHttpRequest","open","form","action","setRequestHeader","addEventListener","postTimer","clearTimeout","setTimeout","status","abort","send","id","hidden","querySelector","pmList","submit","closeBtn","close","show","bind","postCB","disabled","getData","validateForm","arg","checkValidity","alert","forceDisabled","submitFn","e","preventDefault","err","console","log","initReport","param","dataset","select","returnOption","label","createNamesOption","names","idx","checkLatLng","all","filter","pmNames","forEach","earseMarkers","Map","renderMarkersInView","twBounds","latLngBounds","layers","tileLayer","bounds","maxZoom","subdomains","attribution","minZoom","ext","labels","layerName","Google","_map","position","control","addTo","on","setPosition","onLoad","onLocationFound","onLocationError","saveLayerName","setView","geo","getCenter","markersInView","getBounds","checkInView","_marker","_latLng","inView","contains","apply","push","isDoubtful","_icon","classList","add","latlng","radius","accuracy","circle","removeLayer","warn","message","m","createLocateBtn","dom","innerText","locateMe","locate","max","locateMeBtn","createReFetchBtn","reFetchBtn","aside","infoBtn","lightenMap","checked","checkToLightenMap","body","toggle","addReport","params","defaultParams","dialog","target","createAddReportBtn","addReportBtn","filterBoxClass","createIndicator","style","scales","reduce","input","insertAdjacentHTML","filterIndicator","ctrls","centerMark"],"mappings":"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"}